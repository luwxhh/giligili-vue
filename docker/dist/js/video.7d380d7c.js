(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["video"],{"43fd":function(e,t,o){"use strict";o.r(t);var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"post-video"},[o("h2",[e._v("欢迎投稿：")]),o("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px"}},[o("el-form-item",{attrs:{label:"标题",rules:[{required:!0,message:"标题不能为空"}]}},[o("el-input",{model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),o("el-form-item",{attrs:{label:"描述"}},[o("el-input",{attrs:{type:"textarea"},model:{value:e.form.info,callback:function(t){e.$set(e.form,"info",t)},expression:"form.info"}})],1),o("el-form-item",{attrs:{label:"视频封面",rules:[{required:!0,message:"封面不能为空"}]}},[o("el-upload",{ref:"upload",staticClass:"avatar-uploader",attrs:{action:"",label:"描述","before-upload":e.fnBeforeUpload,"http-request":e.fnUploadRequest,"show-file-list":!1}},[e.imageUrl?o("img",{staticClass:"avatar",attrs:{src:e.imageUrl}}):o("i",{staticClass:"el-icon-plus avatar-uploader-icon"}),o("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传png文件，且不超过500kb")])])],1),o("el-form-item",{attrs:{label:"视频"}},[o("el-upload",{staticClass:"upload-demo",attrs:{action:"","before-upload":e.vBeforeUpload,"http-request":e.vUploadRequest,multiple:"",limit:1,"on-exceed":e.handleExceed}},[o("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),o("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传MP4文件，且请您自行压缩")])],1)],1),o("el-form-item",[o("el-progress",{attrs:{percentage:e.percentage,color:e.customColorMethod,"show-text":!1}})],1),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("立即创建")])],1)],1)],1)},r=[],n=(o("7f7f"),o("76e5")),s=o("bc3a"),i=o.n(s),l=function(e){return i.a.post("/api/v1/upload/token",{filename:e}).then(function(e){return e.data})},u=function(e){return i.a.post("/api/v1/upload/tack",{filename:e}).then(function(e){return e.data})},c={name:"PostVideo",data:function(){return{imageUrl:"",dialogImageUrl:"",percentage:0,customColor:"#409eff",videoUrl:"",dialogVideoUrl:"",dialogVisible:!1,form:{title:"",info:"",url:"",avatar:""}}},methods:{fnBeforeUpload:function(e){var t="image/png"===e.type,o=e.size/1024/1024<2;return t||this.$message.error("上传头像图片只能是 PNG 格式!"),o||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&o},fnUploadRequest:function(e){var t=this;l(e.file.name).then(function(o){var a=new XMLHttpRequest;a.open("PUT",o.data.put,!0),a.send(e.file),a.onload=function(){t.imageUrl=o.data.get,t.form.avatar=o.data.key}}).catch(function(e){t.$notify.error({title:"网路错误，或者服务器宕机",message:e})})},vBeforeUpload:function(e){var t="video/mp4"===e.type;return t||this.$message.error("上传视频只能是 mp4 格式!"),t},customColorMethod:function(e){return e<50?"#909399":e<100?"#e6a23c":"#67c23a"},vUploadRequest:function(e){var t=this;u(e.file.name).then(function(o){var a=new XMLHttpRequest;a.upload.onprogress=function(e){e.lengthComputable&&(t.percentage=Math.floor(e.loaded/e.total*100),console.log(t.percentage))},a.open("PUT",o.data.put,!0),a.send(e.file),a.onload=function(){t.form.url=o.data.key,t.$notify({title:"视频上传成功",message:"success",type:"success"})}}).catch(function(e){t.$notify.error({title:"网路错误，或者服务器宕机",message:e})})},handleExceed:function(e){this.$message.warning("仅可上传一个视频")},onSubmit:function(){var e=this;this.percentage=0,n["c"](this.form).then(function(t){t.status>0?e.$notify.error({title:"投稿失败",message:t.msg}):e.$notify({title:"投稿成功",message:"您的投稿ID为".concat(t.data.id),type:"success"})}).catch(function(t){e.$notify.error({title:"投稿失败惹",message:t})})}},comments:{}},f=c,m=(o("48bf"),o("2877")),p=Object(m["a"])(f,a,r,!1,null,null,null);t["default"]=p.exports},"48bf":function(e,t,o){"use strict";var a=o("65cc"),r=o.n(a);r.a},"65cc":function(e,t,o){},7555:function(e,t,o){"use strict";o.d(t,"a",function(){return n}),o.d(t,"b",function(){return s});var a=o("bc3a"),r=o.n(a),n=function(e){return r.a.post("/api/v1/user/login",e).then(function(e){return e.data})},s=function(e){return r.a.post("/api/v1/user/register",e).then(function(e){return e.data})}},"7f7f":function(e,t,o){var a=o("86cc").f,r=Function.prototype,n=/^\s*function ([^ (]*)/,s="name";s in r||o("9e1e")&&a(r,s,{configurable:!0,get:function(){try{return(""+this).match(n)[1]}catch(e){return""}}})},a55b:function(e,t,o){"use strict";o.r(t);var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"login"},[o("h2",[e._v("登录：")]),o("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px"}},[o("el-form-item",{attrs:{label:"账号",rules:[{required:!0,message:"账号不能为空"}]}},[o("el-input",{model:{value:e.form.user_name,callback:function(t){e.$set(e.form,"user_name",t)},expression:"form.user_name"}})],1),o("el-form-item",{attrs:{label:"密码",rules:[{required:!0,message:"密码不能为空"}]}},[o("el-input",{attrs:{type:"password"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("登录")]),o("el-button",{nativeOn:{click:function(t){return e.onRegister(t)}}},[e._v("注册")])],1)],1)],1)},r=[],n=o("7555"),s={name:"Login",data:function(){return{form:{user_name:"",password:""}}},methods:{onSubmit:function(){var e=this;n["a"](this.form).then(function(t){t.status>0?e.$notify.error({title:"登录失败",message:t.msg}):(e.$notify({title:"登录成功",message:"success",type:"success"}),e.$router.push({name:"home"}))}).catch(function(t){e.$notify.error({title:"登录失败惹",message:t})})},onRegister:function(){this.$router.push({name:"Register"})}},comments:{}},i=s,l=o("2877"),u=Object(l["a"])(i,a,r,!1,null,null,null);t["default"]=u.exports}}]);
//# sourceMappingURL=video.7d380d7c.js.map